var WIDTH = 960;
var HEIGHT = 600;

var HALF_WIDTH = WIDTH / 2;
var HALF_HEIGHT = HEIGHT / 2; 
var UNIT_SIZE = 20;
var HALF_UNIT_SIZE = UNIT_SIZE/2;
//new
var GRID_SIZE = 20;
var xGRID_SIZE =60;
var yGRID_SIZE =30;

var xGRID_MAX = WIDTH/GRID_SIZE;
var yGRID_MAX = HEIGHT/GRID_SIZE;
var xCell = 0;
var yCell = 0;
var xGrid = 0;
var yGrid = 0;
var xG=0;
var yG=0;
var WEATHER=0;
var WEATHERTEXT=["Normal","Sunny","Rain"];
var dxWIND=0;
var dyWIND=0;
var WIND=0;
var MSGDelay=2000;
var BLOCK = [];
var TOPWALL = [];
var LADDER = [];
var POSGATE =[];
var POS1 = [];
var POS2 = [];
var POS3 = [];
// end new

//Map0
BLOCK.push
	({
		x 	: [],
		y	: [] 
	});
TOPWALL.push
	({
		x 	: [],
		y	: [] 
	});
LADDER.push
	({
		x 	: [],
		y	: [] 
	});
POSGATE.push
	({
		x 	: [],
		y	: [] 
	});
POS1.push
	({
		x 	: [],
		y	: [] 
	});
POS2.push
	({
		x 	: [],
		y	: [] 
	});
POS3.push
	({
		x 	: [],
		y	: [] 
	});

//Map001
BLOCK.push
	({
		x 	: [12,13,13,13,13,13,13,13,13,13,14,14,14,14,14,14,14,14,14,15,15,15,15,16,16,16,16,17,17,18,18,18,18,19,19,20,20,21,21,21,21,21,21,21,21,21,21,21,21,22,22,22,22,22,22,22,22,22,22,22,12,12,12,12,12,12,12,12,12,12,20,20,20,20,20,20,20,20,20,20,13,14,15,16,17,18,19,13,14,15,16,18,19,13,14,19,19],
		y	: [ 6, 7, 6, 3, 2, 0,-1,-2,-3,-4, 7, 6, 3, 2, 0,-1,-2,-3,-4, 7, 6,-3,-4, 7, 6,-3,-4, 7, 6, 7, 6,-3,-4, 7, 6, 7, 6, 7, 6, 5, 4, 3, 2, 0,-1,-2,-3,-4,-5, 7, 6, 5, 4, 3, 2, 0,-1,-2,-3,-4, 5, 4, 3, 2, 0,-1,-2,-3,-4,-5, 5, 4, 3, 2, 0,-1,-2,-3,-4,-5, 5, 5, 5, 5, 5, 5, 5,-5,-5,-5,-5,-5,-5, 4, 4,-3,-4] 
	});
TOPWALL.push
	({
		x 	: [12,12,12,12,12,12,12,12,12,12,12,20,20,20,20,20,20,20,20,20,20,20,13,14,15,16,17,18,19,13,14,15,16,17,18,19],
		y	: [ 5, 4, 3, 2, 1, 0,-1,-2,-3,-4,-5, 5, 4, 3, 2, 1, 0,-1,-2,-3,-4,-5, 5, 5, 5, 5, 5, 5, 5,-5,-5,-5,-5,-5,-5,-5] 
	});
LADDER.push
	({
		x 	: [13,14,19,19],
		y	: [ 4, 4,-3,-4] 
	});
POSGATE.push
	({
		x 	: [22,17,12,21,17,13],
		y	: [ 1,-5, 1, 1,-4, 1] 
	});
POS1.push
	({
		x 	: [14,15,16,17,18,19,20,21,22,23,23,23,23,23,23,23,23,23,23,23],
		y	: [ 8, 8, 8, 8, 8, 8, 8, 8, 8, 7, 6, 5, 4, 3, 2, 1, 0,-1,-2,-3]  
	});
POS2.push
	({
		x 	: [14,15,16,17,18,19,20,21,22,24,24,24,24,24,24,24,24,24,24,24],
		y	: [ 9, 9, 9, 9, 9, 9, 9, 9, 9, 7, 6, 5, 4, 3, 2, 1, 0,-1,-2,-3]  
	});
POS3.push
	({
		x 	: [14,15,16,17,18,19,20,21,22,25,25,25,25,25,25,25,25,25,25,25],
		y	: [10,10,10,10,10,10,10,10,10, 7, 6, 5, 4, 3, 2, 1, 0,-1,-2,-3]  
	});

//Map002
BLOCK.push
	({
		x 	: [ 6, 7,8,8,8, 8, 8,9, 9,10,10,11,11,12,18,18,18,19,19,20,20,21,21,22,22,23,23,24,24,25,25,26,26,27,27,28,28],
		y	: [-5,-4,7,6,5,-2,-3,4,-1, 3, 0, 2, 1, 2, 4, 3, 2, 5, 2, 6, 1, 6, 1, 7, 1, 7, 1, 8, 0, 8, 0, 9,-1,10,-1,10,-2] 
	});
TOPWALL.push
	({
		x 	: [],
		y	: [] 
	});
LADDER.push
	({
		x 	: [],
		y	: [] 
	});
POSGATE.push
	({
		x 	: [],
		y	: [] 
	});
POS1.push
	({
		x 	: [],
		y	: [] 
	});
POS2.push
	({
		x 	: [],
		y	: [] 
	});
POS3.push
	({
		x 	: [],
		y	: [] 
	});

//Map003
BLOCK.push
	({
		x 	: [12,13,13,13,13,13,13,13,13,13,14,14,14,14,14,14,14,14,14,15,15,15,15,16,16,16,16,17,17,18,18,18,18,19,19,20,20,21,21,21,21,21,21,21,21,21,21,21,21,22,22,22,22,22,22,22,22,22,22,22,12,12,12,12,12,12,12,12,12,12,20,20,20,20,20,20,20,20,20,20,13,14,15,16,17,18,19,13,14,15,16,18,19,13,14,19,19,12,22],
		y	: [ 6, 7, 6, 3, 2, 0,-1,-2,-3,-4, 7, 6, 3, 2, 0,-1,-2,-3,-4, 7, 6,-3,-4, 7, 6,-3,-4, 7, 6, 7, 6,-3,-4, 7, 6, 7, 6, 7, 6, 5, 4, 3, 2, 0,-1,-2,-3,-4,-5, 7, 6, 5, 4, 3, 2, 0,-1,-2,-3,-4, 5, 4, 3, 2, 0,-1,-2,-3,-4,-5, 5, 4, 3, 2, 0,-1,-2,-3,-4,-5, 5, 5, 5, 5, 5, 5, 5,-5,-5,-5,-5,-5,-5, 4, 4,-3,-4, 7,-5] 
	});
TOPWALL.push
	({
		x 	: [13,13,13,13,13,13,13,13,13,14,20,21,21,21,21,21,21,21,21,21,21,20,13,14,15,16,17,18,19,13,14,15,16,17,18,19,20,20,21],
		y	: [ 5, 4, 3, 2, 1, 0,-1,-2,-3, 5,-4, 5, 4, 3, 2, 1, 0,-1,-2,-3,-4,-3, 6, 6, 6, 6, 6, 6, 6,-4,-4,-4,-4,-4,-4,-4, 5, 6, 6] 
	});
LADDER.push
	({
		x 	: [14,19],
		y	: [ 4,-3] 
	});
POSGATE.push
	({
		x 	: [21,17,13,22,17,12],
		y	: [ 1,-4, 1, 1,-5, 1] 
	});
POS1.push
	({
		x 	: [14,15,16,17,18,19,20,21,22,23,23,23,23,23,23,23,23,23,23,23],
		y	: [ 8, 8, 8, 8, 8, 8, 8, 8, 8, 7, 6, 5, 4, 3, 2, 1, 0,-1,-2,-3]  
	});
POS2.push
	({
		x 	: [14,15,16,17,18,19,20,21,22,24,24,24,24,24,24,24,24,24,24,24],
		y	: [ 9, 9, 9, 9, 9, 9, 9, 9, 9, 7, 6, 5, 4, 3, 2, 1, 0,-1,-2,-3]  
	});
POS3.push
	({
		x 	: [14,15,16,17,18,19,20,21,22,25,25,25,25,25,25,25,25,25,25,25],
		y	: [10,10,10,10,10,10,10,10,10, 7, 6, 5, 4, 3, 2, 1, 0,-1,-2,-3]  
	});

var MAPS = [];

MAPS.push
	({		
		numEnemies		: 10,
		numWaves		: 5,
		HP	 			: 500,
		roadsX			: [
							[50,50,50,50,HALF_WIDTH,HALF_WIDTH,300,300],
							[200,200,300,300,50,50,HALF_WIDTH,HALF_WIDTH,300,300],
							[WIDTH,300,300,300,50,50,HALF_WIDTH,HALF_WIDTH,300,300]
						],
		roadsY			: [
							[0,50,110,250,350,HALF_HEIGHT,250,HEIGHT],
							[0,50,50,110,110,250,350,HALF_HEIGHT,250,HEIGHT],
							[50,50,50,110,110,250,350,HALF_HEIGHT,250,HEIGHT]
						]
	});
MAPS.push
	({		
		numEnemies		: 10,
		numWaves		: 10,
		HP	 			: 700,
		roadsX			: [
							[50,50,50,150,150,350,350,50,50,200,HALF_WIDTH],
							[150,150,150,150,HALF_WIDTH,300,300],
							
						],
		roadsY			: [
							[0,110,150,150,50,50,250,250,350,350,HEIGHT],
							[0,110,150,HALF_HEIGHT,HALF_HEIGHT,250,HEIGHT],							
						]		
	});
var MapFactory = {};
MapFactory.getData = function(level){
// find the total length of road
	function calcLength(level)
	{	
		var data = MAPS[level];
		data.lengths = [];
		for(var i = 0;i < data.roadsX.length; i++)
		{
			var roadX = data.roadsX[i];
			var roadY = data.roadsY[i];
			var length = 0;
			for(var j = 1;j < roadX.length ; j++)
			{
				var x1 = roadX[j-1],
					y1 = roadY[j-1],
					x2 = roadX[j],
					y2 = roadY[j];			
				length += Math.sqrt(Math.pow(x2 - x1, 2) + Math.pow(y2 - y1, 2));
			}
			data.lengths.push(length);
			
		}	
		return data;
	}
	return calcLength(level);
}





